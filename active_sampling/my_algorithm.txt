Input: ğ‘“_ğœƒ (ğ»,ğ‘¡)  , ğœ_ğ‘›^2  , ğ›¾ , ğœ , ğ‘_ğ‘,ğ‘_ğ‘”ğ‘’ğ‘›,ğ‘Œ_0,ğœ‰
Initializations: estimate ğœÂ Ì‚_(ğ»_ğœ )  , ğ‘¡_0  , ğ›¿,{ğ»Â Ìƒ_ğ‘–^((ğ‘¡_0 ) ) }_(ğ‘–=1)^(ğ‘_ğ‘ )
 For ğ‘–=1,â€¦,ğ‘_ğ‘:  
     while ğ‘¡>0:
     ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡â†ğ‘¡âˆ’ğ‘Ÿğ‘œğ‘¢ğ‘›ğ‘‘(ğ‘¡_0/ğ‘_ğ‘”ğ‘’ğ‘› )
     ğ»Â Ìƒ_ğ‘–^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )â†ğ‘“_ğœƒ (ğ»Â Ì‚_ğ‘–^((ğ‘¡)),ğ‘¡)
     ğœ–Â Ìƒ^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )â†(ğ»Â Ì‚_ğ‘–^((ğ‘¡) )âˆ’âˆš(ğ›¼Â Ì…_ğ’• )ğ»Â Ìƒ_ğ‘–^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) ) )/âˆš(1âˆ’ğ›¼Â Ì…_ğ‘¡ ) 
     ğ»Â Ì‚_ğ‘–^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )â†âˆš(ğ›¼Â Ì…_(ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) ) ğ»Â Ìƒ_ğ‘–^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )+âˆš(1âˆ’ğ›¼Â Ì…_(ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) ) ğœ–Â Ìƒ^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )
     ğ»Â Ì‚_ğ‘–^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )â†ğ»Â Ì‚_ğ‘–^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )âˆ’ğœ‰âˆ‡_(ğ»_ğ‘–^((ğ‘¡) ) ) â€–ğ‘Œ_ğœâˆ’ğœÂ Ì‚_(ğ»_ğœ )âˆ™ğ»Â Ìƒ_ğ‘–^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) ) @ diga(ğ‘¥_ğœ) â€–_2^2
     if ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡âˆˆğ‘†:
            ğœâ†ğœ+1 
           ğ‘—^âˆ—=argâ¡maxâ”¬(ğ‘—âˆˆğ’Ÿ)â¡[âˆ‘_ğ‘–^(ğ‘_ğ‘)â–’logâ¡âˆ‘_ğ‘—^(ğ‘_ğ‘)â–’expâ¡{âˆ‘_(ğ‘™âˆˆğ’Ÿ)â–’âˆ‘_(ğ‘˜=1)^(ğ‘_ğ‘)â–’(ğ»Â Ìƒ_(ğ‘–_(ğ‘˜,ğ‘™))^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) )âˆ’ğ»Â Ìƒ_(ğ‘—_(ğ‘˜,ğ‘™))^((ğ‘¡_ğ‘›ğ‘’ğ‘¥ğ‘¡ ) ) )^2 }  ] 
          ğ‘¥_ğœ={â–ˆ(1                 ğ‘–ğ‘“ ğ‘–â‰ ğ‘—^âˆ—@[ğ‘¥_(ğœâˆ’1) ]_ğ‘–       ğ‘–ğ‘“ ğ‘–=ğ‘—^âˆ— )â”¤
          ğ‘¦_(ğ½^âˆ— )=ğ‘¥_(ğ½^âˆ— ) â„_(ğ½^âˆ— )+ğ‘›_ğœ;    ğ‘›_ğœ~ğ’ğ’©(0,ğ¼)
          update ğ‘Œ_ğœ
          update ğœÂ Ì‚_(ğ»_ğœ )=â€–ğ‘Œ_ğœ â€–_ğ‘“ğ‘Ÿğ‘œ/âˆš(ğ‘_ğ‘ ğ‘_ğ‘ )
Return {ğœÂ Ì‚_(ğ»_ğœ ) ğ»Â Ìƒ_ğ‘–^((ğ‘¡_ğ‘“ğ‘–ğ‘›ğ‘ğ‘™ ) ) }_(ğ‘–=1)^(ğ‘_ğ‘ )

initializations: 
1) estimation of channel gain ğœÂ Ì‚_ğ»=â€–ğ‘Œ_0 â€–_ğ‘“ğ‘Ÿğ‘œ/âˆš(ğ‘_ğ‘ ğ‘_ğ‘ ) 
2) estimate initial time step from the average energy and diffusion scheduale: 
  t_0 = argmin_1 {alphabar_t - gamma * (|P|/(|P|+|DI))} 
  where |P| , |D| is the cardinallity of each subset of indices meanining 
  |P| = nuber of pilots 
  |P|+|D| = number of subcarrires
3) set gamma and compute delta: 
   delta = sqrt(1 - gamma^2(1 + sigma^2_n/sigma^2_H)|P|/(|P|+|D|))
   where sigma_n is from training
3) set initial channel particles: 
   h_i^(t_0) = gamma * (y_i / (sigma_H*x_i)) + delta * epsilon_i   for i in P
   h_i^(t_0) = delta * epsilon_i                                 for i in D
   where h_i is column in a particle, and epsiloni_i ~ CN(0,I)